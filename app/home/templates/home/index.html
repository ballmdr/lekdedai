{% extends "base.html" %}

{% block title %}LekDedAI - เลขเด็ดจาก AI{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="gradient-bg text-white py-20">
    <div class="container mx-auto px-4 text-center">
        <h1 class="text-4xl md:text-6xl font-bold mb-8">
            เลขเด็ด AI ประจำงวด 1 มกราคม 2568
        </h1>
        
        <!-- Lucky Numbers Display -->
        <div class="flex justify-center items-center space-x-6 mb-8 flex-wrap">
            <div class="lucky-number text-white text-4xl md:text-6xl font-bold rounded-full w-24 h-24 md:w-32 md:h-32 flex items-center justify-center shadow-2xl">
                78
            </div>
            <div class="lucky-number text-white text-4xl md:text-6xl font-bold rounded-full w-24 h-24 md:w-32 md:h-32 flex items-center justify-center shadow-2xl">
                51
            </div>
            <div class="lucky-number text-white text-4xl md:text-6xl font-bold rounded-full w-24 h-24 md:w-32 md:h-32 flex items-center justify-center shadow-2xl">
                492
            </div>
        </div>
        
        <p class="text-xl md:text-2xl mb-8 text-gray-100">
            วิเคราะห์จากสถิติย้อนหลังและแนวโน้มด้วย Machine Learning
        </p>
        
        <a href="/ai/" class="inline-block bg-yellow-400 text-gray-900 text-xl font-bold px-8 py-4 rounded-full hover:bg-yellow-300 transition-all transform hover:scale-105 shadow-2xl mb-8">
            ดูเลขเด็ด AI ทั้งหมด
        </a>
        
        <!-- Countdown Timer -->
        <div class="countdown-timer inline-block px-6 py-3 rounded-full">
            <p class="text-sm font-medium mb-2">เหลือเวลาก่อนประกาศผล:</p>
            <div id="countdown-timer" class="text-2xl font-bold">5 วัน 10:30:15</div>
        </div>
    </div>
</section>

<!-- Interactive Tools Section -->
<section class="py-16 bg-gray-100">
    <div class="container mx-auto px-4">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- Lottery Checker -->
            <div class="bg-white rounded-2xl shadow-xl p-8 card-hover">
                <h3 class="text-2xl font-bold mb-6 text-center text-purple-600">
                    <i class="fas fa-search mr-3"></i>
                    ตรวจผลสลากกินแบ่งรัฐบาลล่าสุด
                </h3>
                <div class="flex space-x-3 mb-4">
                    <input 
                        type="text" 
                        id="lotteryInput"
                        placeholder="กรอกเลข 6 หลักของคุณที่นี่" 
                        class="flex-1 px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-purple-500 text-lg"
                        maxlength="6"
                        pattern="[0-9]{6}"
                    >
                    <button 
                        onclick="checkLottery()"
                        id="lotteryBtn"
                        class="bg-purple-600 text-white px-6 py-3 rounded-lg hover:bg-purple-700 transition-colors font-semibold"
                    >
                        ตรวจรางวัล
                    </button>
                </div>
                
                <!-- Loading -->
                <div id="lotteryLoading" class="hidden text-center py-4">
                    <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600"></div>
                    <p class="mt-2 text-gray-600">กำลังตรวจสอบ...</p>
                </div>
                
                <!-- Results -->
                <div id="lotteryResults" class="hidden">
                    <div class="bg-purple-50 rounded-lg p-4 mb-4">
                        <h4 class="font-semibold text-purple-800 mb-2">ผลการตรวจสอบ:</h4>
                        <div id="lotteryResultText" class="text-purple-700"></div>
                    </div>
                    
                    <button 
                        onclick="resetLotteryForm()"
                        class="w-full bg-gray-500 text-white py-2 rounded-lg hover:bg-gray-600 transition-colors"
                    >
                        ตรวจใหม่
                    </button>
                </div>
            </div>
            
            <!-- Dream Interpretation -->
            <div class="bg-white rounded-2xl shadow-xl p-8 card-hover">
                <h3 class="text-2xl font-bold mb-6 text-center text-blue-600">
                    <i class="fas fa-moon mr-3"></i>
                    ตีความฝันให้เป็นเลข
                </h3>
                <div class="flex space-x-3 mb-4">
                    <input 
                        type="text" 
                        id="dreamInput"
                        placeholder="คุณฝันว่าอะไร? เช่น 'ฝันเห็นช้าง'" 
                        class="flex-1 px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-blue-500 text-lg"
                    >
                    <button 
                        onclick="interpretDream()"
                        id="dreamBtn"
                        class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors font-semibold"
                    >
                        ค้นหาคำทำนาย
                    </button>
                </div>
                
                <!-- Loading -->
                <div id="dreamLoading" class="hidden text-center py-4">
                    <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div>
                    <p class="mt-2 text-gray-600">กำลังวิเคราะห์ความฝัน...</p>
                </div>
                
                <!-- Results -->
                <div id="dreamResults" class="hidden">
                    <div class="bg-blue-50 rounded-lg p-4 mb-4">
                        <h4 class="font-semibold text-blue-800 mb-2">คำทำนาย:</h4>
                        <p id="dreamInterpretation" class="text-blue-700"></p>
                    </div>
                    
                    <div class="bg-gray-50 rounded-lg p-4 mb-4">
                        <h4 class="font-semibold text-gray-800 mb-3">เลขมงคลจากความฝัน:</h4>
                        <div id="dreamNumbers" class="grid grid-cols-3 gap-3"></div>
                    </div>
                    
                    <button 
                        onclick="resetDreamForm()"
                        class="w-full bg-gray-500 text-white py-2 rounded-lg hover:bg-gray-600 transition-colors"
                    >
                        ตีความใหม่
                    </button>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Core Features Section -->
<section class="py-16">
    <div class="container mx-auto px-4">
        <h2 class="text-4xl font-bold text-center mb-16">ฟีเจอร์หลักของเรา</h2>
        
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
            <!-- Feature Card 1 -->
            <div class="feature-card-1 text-white rounded-2xl p-8 text-center card-hover">
                <div class="text-5xl mb-4">
                    <i class="fas fa-brain"></i>
                </div>
                <h3 class="text-xl font-bold mb-3">เลขเด็ด AI</h3>
                <p class="text-gray-100">วิเคราะห์ด้วย Machine Learning</p>
            </div>
            
            <!-- Feature Card 2 -->
            <div class="feature-card-2 text-white rounded-2xl p-8 text-center card-hover">
                <div class="text-5xl mb-4">
                    <i class="fas fa-moon"></i>
                </div>
                <h3 class="text-xl font-bold mb-3">ตีความฝัน</h3>
                <p class="text-gray-100">แปลความฝันเป็นเลขนำโชค</p>
            </div>
            
            <!-- Feature Card 3 -->
            <div class="feature-card-3 text-white rounded-2xl p-8 text-center card-hover">
                <div class="text-5xl mb-4">
                    <i class="fas fa-chart-bar"></i>
                </div>
                <h3 class="text-xl font-bold mb-3">สถิติหวย</h3>
                <p class="text-gray-100">วิเคราะห์ข้อมูลสถิติย้อนหลัง</p>
            </div>
            
            <!-- Feature Card 4 -->
            <div class="feature-card-4 text-white rounded-2xl p-8 text-center card-hover">
                <div class="text-5xl mb-4">
                    <i class="fas fa-ticket-alt"></i>
                </div>
                <h3 class="text-xl font-bold mb-3">ตรวจหวย</h3>
                <p class="text-gray-100">ตรวจผลสลากกินแบ่งรัฐบาล</p>
            </div>
        </div>
    </div>
</section>

<!-- How It Works Section -->
<section class="py-16 bg-gray-50">
    <div class="container mx-auto px-4">
        <h2 class="text-4xl font-bold text-center mb-16">LekDedAI ทำงานอย่างไร?</h2>
        
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
            <!-- Step 1 -->
            <div class="text-center">
                <div class="bg-purple-600 text-white text-4xl rounded-full w-20 h-20 flex items-center justify-center mx-auto mb-6">
                    <i class="fas fa-database"></i>
                </div>
                <h3 class="text-xl font-bold mb-3">1. รวบรวมสถิติ</h3>
                <p class="text-gray-600">รวบรวมข้อมูลผลสลากย้อนหลังมากกว่า 10 ปี</p>
            </div>
            
            <!-- Step 2 -->
            <div class="text-center">
                <div class="bg-blue-600 text-white text-4xl rounded-full w-20 h-20 flex items-center justify-center mx-auto mb-6">
                    <i class="fas fa-robot"></i>
                </div>
                <h3 class="text-xl font-bold mb-3">2. วิเคราะห์ด้วย AI</h3>
                <p class="text-gray-600">ค้นหาแพทเทิร์นและความน่าจะเป็นที่ซ่อนอยู่</p>
            </div>
            
            <!-- Step 3 -->
            <div class="text-center">
                <div class="bg-green-600 text-white text-4xl rounded-full w-20 h-20 flex items-center justify-center mx-auto mb-6">
                    <i class="fas fa-lightbulb"></i>
                </div>
                <h3 class="text-xl font-bold mb-3">3. สร้างชุดเลขเด็ด</h3>
                <p class="text-gray-600">นำเสนอชุดเลขที่มีโอกาสสูงสุดสำหรับงวดถัดไป</p>
            </div>
        </div>
    </div>
</section>

<!-- News & Content Section -->
<section class="py-16">
    <div class="container mx-auto px-4">
        <h2 class="text-4xl font-bold text-center mb-16">ข่าวสารและบทความน่าสนใจ</h2>
        
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
            <!-- Article Card 1 -->
            <div class="bg-white rounded-2xl shadow-xl overflow-hidden card-hover">
                <div class="h-48 bg-gradient-to-br from-purple-400 to-pink-400 flex items-center justify-center">
                    <i class="fas fa-newspaper text-6xl text-white opacity-80"></i>
                </div>
                <div class="p-6">
                    <h3 class="text-xl font-bold mb-3 text-gray-800">ส่องเลขเด็ดทะเบียนรถนายกฯ ประจำงวดนี้</h3>
                    <p class="text-gray-600 mb-4">วิเคราะห์เลขเด็ดจากทะเบียนรถของบุคคลสำคัญที่มักให้โชค</p>
                    <a href="/news/" class="text-purple-600 font-semibold hover:text-purple-700 transition-colors">
                        อ่านเพิ่มเติม →
                    </a>
                </div>
            </div>
            
            <!-- Article Card 2 -->
            <div class="bg-white rounded-2xl shadow-xl overflow-hidden card-hover">
                <div class="h-48 bg-gradient-to-br from-blue-400 to-cyan-400 flex items-center justify-center">
                    <i class="fas fa-moon text-6xl text-white opacity-80"></i>
                </div>
                <div class="p-6">
                    <h3 class="text-xl font-bold mb-3 text-gray-800">รวม 10 ความฝันยอดฮิตที่มักให้โชค</h3>
                    <p class="text-gray-600 mb-4">ความฝันที่พบบ่อยและมักนำโชคมาให้ผู้ฝัน</p>
                    <a href="/dreams/" class="text-blue-600 font-semibold hover:text-blue-700 transition-colors">
                        อ่านเพิ่มเติม →
                    </a>
                </div>
            </div>
            
            <!-- Article Card 3 -->
            <div class="bg-white rounded-2xl shadow-xl overflow-hidden card-hover">
                <div class="h-48 bg-gradient-to-br from-green-400 to-emerald-400 flex items-center justify-center">
                    <i class="fas fa-chart-line text-6xl text-white opacity-80"></i>
                </div>
                <div class="p-6">
                    <h3 class="text-xl font-bold mb-3 text-gray-800">สถิติเลขเบิ้ล-เลขหาม ที่น่าจับตามอง</h3>
                    <p class="text-gray-600 mb-4">วิเคราะห์สถิติเลขที่ออกบ่อยและเลขที่หายไปนาน</p>
                    <a href="/lotto_stats/" class="text-green-600 font-semibold hover:text-green-700 transition-colors">
                        อ่านเพิ่มเติม →
                    </a>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- CTA Section -->
<section class="py-16 bg-gradient-to-r from-purple-600 to-blue-600 text-white">
    <div class="container mx-auto px-4 text-center">
        <h2 class="text-4xl font-bold mb-6">พร้อมที่จะได้เลขเด็ดแล้วหรือยัง?</h2>
        <p class="text-xl mb-8 text-gray-100">เริ่มต้นใช้งาน LekDedAI วันนี้ และเพิ่มโอกาสในการถูกรางวัล</p>
        <div class="flex flex-col sm:flex-row gap-4 justify-center">
            <a href="/ai/" class="bg-yellow-400 text-gray-900 px-8 py-4 rounded-full font-bold text-lg hover:bg-yellow-300 transition-all transform hover:scale-105">
                ดูเลขเด็ด AI
            </a>
            <a href="/dreams/" class="bg-white text-purple-600 px-8 py-4 rounded-full font-bold text-lg hover:bg-gray-100 transition-all transform hover:scale-105">
                ตีความฝัน
            </a>
            <a href="/lottery_checker/" class="bg-green-500 text-white px-8 py-4 rounded-full font-bold text-lg hover:bg-green-600 transition-all transform hover:scale-105">
                ตรวจหวย
            </a>
        </div>
    </div>
</section>

<script>
// Dream Interpretation Functions
async function interpretDream() {
    const dreamInput = document.getElementById('dreamInput');
    const dreamBtn = document.getElementById('dreamBtn');
    const dreamLoading = document.getElementById('dreamLoading');
    const dreamResults = document.getElementById('dreamResults');
    
    const dreamText = dreamInput.value.trim();
    
    if (!dreamText) {
        alert('กรุณากรอกความฝันของคุณ');
        return;
    }
    
    // Show loading
    dreamLoading.classList.remove('hidden');
    dreamBtn.disabled = true;
    dreamResults.classList.add('hidden');
    
    try {
        const response = await fetch('/dreams/analyze/', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRFToken': getCookie('csrftoken')
            },
            body: JSON.stringify({
                dream_text: dreamText
            })
        });
        
        const data = await response.json();
        
        if (data.success) {
            // Show results
            document.getElementById('dreamInterpretation').textContent = data.result.interpretation;
            
            // Show numbers
            const numbersContainer = document.getElementById('dreamNumbers');
            numbersContainer.innerHTML = '';
            
            data.result.numbers.forEach(number => {
                const div = document.createElement('div');
                div.className = 'bg-white border-2 border-blue-300 rounded-lg p-3 text-center';
                div.innerHTML = `<span class="text-xl font-bold text-blue-600">${number}</span>`;
                numbersContainer.appendChild(div);
            });
            
            dreamResults.classList.remove('hidden');
        } else {
            alert(data.error || 'เกิดข้อผิดพลาด กรุณาลองใหม่');
        }
    } catch (error) {
        alert('เกิดข้อผิดพลาด: ' + error.message);
    } finally {
        dreamLoading.classList.add('hidden');
        dreamBtn.disabled = false;
    }
}

function resetDreamForm() {
    document.getElementById('dreamInput').value = '';
    document.getElementById('dreamResults').classList.add('hidden');
    document.getElementById('dreamLoading').classList.add('hidden');
    document.getElementById('dreamBtn').disabled = false;
}

// Lottery Checker Functions
async function checkLottery() {
    const lotteryInput = document.getElementById('lotteryInput');
    const lotteryBtn = document.getElementById('lotteryBtn');
    const lotteryLoading = document.getElementById('lotteryLoading');
    const lotteryResults = document.getElementById('lotteryResults');
    const lotteryResultText = document.getElementById('lotteryResultText');

    const lotteryNumber = lotteryInput.value.trim();

    if (!lotteryNumber) {
        alert('กรุณากรอกเลขสลากที่ต้องการตรวจ');
        return;
    }

    // Show loading
    lotteryLoading.classList.remove('hidden');
    lotteryBtn.disabled = true;
    lotteryResults.classList.add('hidden');
    lotteryResultText.textContent = ''; // Clear previous results

    try {
        const response = await fetch('/lottery_checker/api/check/', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRFToken': getCookie('csrftoken')
            },
            body: JSON.stringify({
                lottery_number: lotteryNumber
            })
        });

        const data = await response.json();

        if (data.success) {
            // Show results
            lotteryResultText.textContent = data.result.message;
            lotteryResults.classList.remove('hidden');
        } else {
            lotteryResultText.textContent = data.error || 'เกิดข้อผิดพลาด กรุณาลองใหม่';
            lotteryResults.classList.remove('hidden');
        }
    } catch (error) {
        lotteryResultText.textContent = 'เกิดข้อผิดพลาด: ' + error.message;
        lotteryResults.classList.remove('hidden');
    } finally {
        lotteryLoading.classList.add('hidden');
        lotteryBtn.disabled = false;
    }
}

function resetLotteryForm() {
    document.getElementById('lotteryInput').value = '';
    document.getElementById('lotteryResults').classList.add('hidden');
    document.getElementById('lotteryLoading').classList.add('hidden');
    document.getElementById('lotteryResultText').textContent = '';
    document.getElementById('lotteryBtn').disabled = false;
}

// Utility function to get CSRF token
function getCookie(name) {
    let cookieValue = null;
    if (document.cookie && document.cookie !== '') {
        const cookies = document.cookie.split(';');
        for (let i = 0; i < cookies.length; i++) {
            const cookie = cookies[i].trim();
            if (cookie.substring(0, name.length + 1) === (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
}

// Enter key support for dream input
document.addEventListener('DOMContentLoaded', function() {
    const dreamInput = document.getElementById('dreamInput');
    if (dreamInput) {
        dreamInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                interpretDream();
            }
        });
    }
    
    // Enter key support for lottery input
    const lotteryInput = document.getElementById('lotteryInput');
    if (lotteryInput) {
        lotteryInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                checkLottery();
            }
        });
    }
});
</script>
{% endblock %}