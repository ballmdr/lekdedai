#!/usr/bin/env python3
# -*- coding: utf-8 -*-
import os
import django
import sys

# Setup Django
sys.path.append('/app')
# เฉพาะใน Docker container เท่านั้น - ไม่ใช้ local database
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'lekdedai.settings')
django.setup()

from news.models import NewsCategory, NewsArticle, LuckyNumberHint
from django.contrib.auth.models import User
from datetime import date, datetime, timedelta
from django.utils import timezone

# ดึงหมวดหมู่
lucky_category = NewsCategory.objects.get(slug='lucky-numbers')
temple_category = NewsCategory.objects.get(slug='temples')
natural_category = NewsCategory.objects.get(slug='natural')
dream_category = NewsCategory.objects.get(slug='dreams')
accident_category = NewsCategory.objects.get(slug='accidents')

# สร้างข่าวตัวอย่าง
news_data = [
    {
        'title': 'เลขเด็ดจากต้นตาลศักดิ์สิทธิ์ วัดประจำจังหวัดนครสวรรค์',
        'slug': 'sacred-palm-tree-nakhon-sawan',
        'category': temple_category,
        'intro': 'ชาวบ้านแห่กราบไหว้ต้นตาลโบราณอายุกว่า 200 ปี หลังมีคนเห็นเลขปรากฏบนลำต้น',
        'content': '''วันนี้ (25 สิงหาคม 2568) ผู้สื่อข่าวได้รับแจ้งจากชาวบ้านในพื้นที่ตำบลบางเมืองใหม่ อำเภอเมืองนครสวรรค์ จังหวัดนครสวรรค์ ว่ามีต้นตาลโบราณที่มีอายุกว่า 200 ปี เกิดเหตุการณ์แปลกประหลาด

นายสมชาย ใจดี อายุ 58 ปี ชาวบ้านในพื้นที่ เล่าว่า เมื่อเช้าวันที่ 23 สิงหาคม ขณะที่เดินผ่านไปมา ได้เห็นลายเส้นบนลำต้นตาลที่ดูคล้ายเลข 86 และ 23 จึงได้นำข่าวไปบอกเล่าให้ชาวบ้านฟัง

หลังจากนั้น ชาวบ้านในพื้นที่ก็เริ่มมาดูกันเป็นจำนวนมาก โดยทุกคนเห็นพ้องกันว่าเป็นเลข 86 และ 23 จริง นอกจากนี้ยังมีเลข 05 ปรากฏอยู่ด้านล่างอีกด้วย

นายสมศักดิ์ ศรีสุข ผู้ใหญ่บ้าน เล่าว่า ต้นตาลต้นนี้เป็นที่เคารพบูชาของชาวบ้านมาช้านาน เพราะเชื่อกันว่าเป็นต้นไม้ศักดิ์สิทธิ์ที่จะช่วยให้คนที่มากราบไหว้ด้วยใจจริงจะได้รับความเป็นสิริมงคล

ปัจจุบันมีชาวบ้านจากหลายจังหวัดมาขอเลขเด็ดกันอย่างต่อเนื่อง โดยเฉพาะเลข 86, 23, และ 05 ที่เชื่อว่าจะนำโชคให้กับผู้ที่ซื้อ''',
        'extracted_numbers': '86, 23, 05',
        'confidence_score': 85,
        'status': 'published',
        'published_date': timezone.now() - timedelta(days=2)
    },
    
    {
        'title': 'หญิงสาวฝันเห็นพ่อที่เสียชีวิตมาบอกเลข 47 ถูกรางวัลที่ 3',
        'slug': 'dream-father-number-47',
        'category': dream_category,
        'intro': 'นางสาวสมใจ อายุ 28 ปี เล่าว่าฝันเห็นพ่อที่เสียชีวิตไปแล้วมาบอกเลข พอตื่นขึ้นมาจำได้แม่นยำ',
        'content': '''นางสาวสมใจ ดีใจ อายุ 28 ปี อาชีพรับจ้างทำความสะอาด เล่าเหตุการณ์ที่ทำให้ชาวบ้านในพื้นที่ต่างตื่นเต้นและขออนุญาตนำเลขไปซื้อ

คืนวันที่ 22 สิงหาคม ฉันฝันเห็นพ่อมาหาในฝัน พ่อเสียชีวิตไปแล้ว 5 ปี ในฝันพ่อแต่งกายด้วยเสื้อขาวกางเกงขาว ดูอ่อนโยนและมีความสุข พ่อบอกกับฉันว่า ลูกเอาเลข 47 ไปซื้อ จะได้เงิน พอตื่นขึ้นมาก็จำได้แม่นยำ

นางสาวสมใจเล่าต่อว่า ตอนแรกไม่แน่ใจว่าจะเชื่อหรือไม่ แต่ด้วยความที่ฝันชัดเจนมาก จึงตัดสินใจซื้อเลข 47 ใส่ท้าย 2 ตัว 100 ใบ

ผลออกมาเลข 47 ถูกท้าย 2 ตัว ได้เงิน 600,000 บาท แต่ที่ประหลาดใจคือเลขนี้ยังออกรางวัลที่ 3 อีกด้วย คือเลข 123847 นางสาวสมใจกล่าว

ปัจจุบันชาวบ้านในพื้นที่แห่ขอเลขจากนางสาวสมใจ โดยเฉพาะเลข 47 และเลขที่เกี่ยวข้อง เช่น 74, 147, 247 เป็นต้น

นางสาวสมใจกล่าวว่า ส่วนตัวเชื่อว่าพ่อคงอยากให้ลูกมีเงินใช้ เพราะช่วงนี้กำลังมีปัญหาทางการเงิน''',
        'extracted_numbers': '47, 74, 147, 247',
        'confidence_score': 70,
        'status': 'published',
        'published_date': timezone.now() - timedelta(days=1)
    },
    
    {
        'title': 'ฟ้าผ่าต้นโพธิ์หน้าศาลเจ้าพ่อหลักเมือง เผยเลขลับ 19 และ 91',
        'slug': 'lightning-bodhi-tree-city-pillar',
        'category': natural_category,
        'intro': 'เหตุการณ์ธรรมชาติประหลาดเมื่อฟ้าผ่าต้นโพธิ์ แต่ต้นไม่ตาย กลับเผยรอยไหม้เป็นลายคล้ายเลข',
        'content': '''เมื่อคืนวันที่ 24 สิงหาคม 2568 เวลาประมาณ 02:30 น. เกิดเหตุการณ์ธรรมชาติที่น่าประหลาดใจที่ศาลเจ้าพ่อหลักเมือง อำเภอเมือง จังหวัดสุโขทัย

นายประยูร สุขใส อายุ 45 ปี เจ้าหน้าที่รักษาความปลอดภัยศาลเจ้า เล่าว่า คืนนั้นฝนตกหนักมาก มีฟ้าร้องฟ้าผ่าอยู่หลายครั้ง แต่ครั้งหนึ่งเสียงดังมากกว่าปกติ เมื่อเช้าตรวจดูจึงพบว่าฟ้าผ่าต้นโพธิ์ใหญ่หน้าศาลเจ้า

สิ่งที่น่าแปลกใจคือ แม้ฟ้าจะผ่า แต่ต้นโพธิ์ยังคงตั้งตระหง่านอยู่ได้ โดยมีเพียงรอยไหม้ที่ลำต้นเท่านั้น และรอยไหม้นั้นกลับมีลักษณะคล้ายเลข 19 และ 91 อย่างชัดเจน

พระครูสิริวัตร เจ้าอาวาสวัดใกล้เคียง ได้มาตรวจดูและกล่าวว่า เป็นเรื่องน่าอัศจรรย์ที่ต้นโพธิ์ไม่ตาย ซึ่งอาจเป็นพรจากเจ้าพ่อหลักเมือง ส่วนเรื่องเลขนั้นเป็นเรื่องของความเชื่อ แต่ถ้าใครมีศรทธาก็สามารถเอาไปอ้างอิงได้

หลังข่าวแพร่ออกไป ชาวบ้านและนักท่องเที่ยวจากหลายจังหวัดแห่มาขอดูรอยฟ้าผ่า และขอเลขเด็ด 19, 91 รวมถึงเลขที่เกี่ยวข้องอื่นๆ

นายสมศักดิ์ ทองดี อายุ 60 ปี ชาวบ้านในพื้นที่ กล่าวว่า ผมเชื่อว่าเป็นลางดี เพราะต้นโพธิ์ไม่ตาย แถมยังเผยเลขให้ด้วย จะลองซื้อเลข 19, 91, 119, 191 ดู''',
        'extracted_numbers': '19, 91, 119, 191',
        'confidence_score': 75,
        'status': 'published',
        'published_date': timezone.now()
    },

    {
        'title': 'รถตู้ทะเบียน 2กข-5874 เกิดอุบัติเหตุ ไร้คนเจ็บ',
        'slug': 'van-accident-no-casualties',
        'category': accident_category,
        'intro': 'รถตู้เสียหลักตกข้างทาง แต่ทุกคนรอดปลอดภัย ชาวบ้านเชื่อว่าเป็นลางดีนำเลขมาให้',
        'content': '''เหตุการณ์เมื่อเวลา 14:30 น. วันที่ 25 สิงหาคม 2568 รถตู้โดยสารประจำทางสาย อุบลราชธานี-กรุงเทพ ทะเบียน 2กข-5874 ขับโดยนายสมชาย ใจกล้า อายุ 52 ปี เกิดอุบัติเหตุตกข้างทาง กม.ที่ 347 ทางหลวงหมายเลข 24

นายสมชาย เล่าว่า ขณะขับผ่านโค้งหักศอก เกิดมีสุนัขวิ่งตัดหน้ารถ ผมเบรกกะทันหัน ทำให้รถเสียหลักไถลไปข้างทาง โชคดีที่ไม่พุ่งชนต้นไม้ และทุกคนในรถปลอดภัย

ในรถตู้มีผู้โดยสารทั้งหมด 8 คน ทุกคนรอดปลอดภัยโดยไม่มีใครได้รับบาดเจ็บแม้แต่นิดเดียว ซึ่งเป็นเรื่องน่าอัศจรรย์เพราะรถเสียหลักค่อนข้างแรง

นายประเสริฐ สุขส่าย อายุ 65 ปี หนึ่งในผู้โดยสาร กล่าวว่า เวลานั้นคิดว่าตายแน่ แต่รถหยุดอย่างนิ่มนวล ไม่มีใครเจ็บ ผมเชื่อว่าเป็นความคุ้มครองจากสิ่งศักดิ์สิทธิ์

หลังเหตุการณ์ ชาวบ้านในพื้นที่มาช่วยเหลือ และสังเกตเห็นหมายเลขทะเบียน 5874 จึงเชื่อว่าเป็นเลขนำโชค เพราะเกิดเหตุแต่ทุกคนปลอดภัย

นางสมจิต ใจดี อายุ 43 ปี ชาวบ้านที่มาช่วยเหลือ กล่าวว่า เห็นแล้วขนลุก รถเสียหลักแบบนี้แต่ไม่มีใครเจ็บ ต้องเป็นเลขดีแน่ๆ เอาเลข 58, 74, 5874 ไปซื้อ

ขณะนี้หน่วยงานที่เกี่ยวข้องได้ช่วยอำนวยความสะดวกในการเดินทางต่อให้กับผู้โดยสารแล้ว''',
        'extracted_numbers': '58, 74, 5874',
        'confidence_score': 65,
        'status': 'published',
        'published_date': timezone.now() - timedelta(hours=6)
    }
]

# สร้างข่าว
for article_data in news_data:
    article, created = NewsArticle.objects.get_or_create(
        slug=article_data['slug'],
        defaults=article_data
    )
    if created:
        print(f'สร้างข่าว: {article.title}')
    else:
        print(f'มีข่าวอยู่แล้ว: {article.title}')

print("เสร็จสิ้นการสร้างข่าวตัวอย่าง")