{% extends "base.html" %}
{% load static %}

{% block title %}LekDedAI - เลขเด็ดจาก AI{% endblock %}

{% block extra_css %}{% endblock %}

{% block content %}

  <!-- Daily Content Hero -->
  <section class="py-12 bg-gradient-to-br from-primary/5 via-background to-secondary/5 relative overflow-hidden">
    <div class="absolute inset-0" style="background: radial-gradient(circle at 30% 20%, rgba(255, 193, 7, 0.1), transparent 50%);"></div>

    <div class="container mx-auto px-4 relative z-10">
      <div class="text-center mb-8">
        <div class="flex items-center justify-center gap-2 mb-4">
          <i class="fas fa-calendar text-primary"></i>
          <span class="text-sm font-medium text-muted-foreground">
            วันที่ {{ thai_current_date }}
          </span>
        </div>
        <h2 class="text-4xl md:text-5xl font-serif font-bold text-foreground mb-4">เลขเด็ดประจำวัน</h2>
        <p class="text-lg text-muted-foreground max-w-2xl mx-auto">อัปเดตเลขเด็ด ข่าวหวย และสถิติล่าสุดทุกวัน</p>
      </div>

      <!-- Today's Featured Numbers -->
      <div class="grid md:grid-cols-3 gap-6 max-w-4xl mx-auto">
        <div class="card border-primary/20 bg-primary/5">
          <div class="p-4 text-center pb-2">
            <h3 class="text-lg font-serif text-foreground mb-2">เลขเด็ด AI</h3>
            <div class="badge bg-primary text-primary-foreground mx-auto mb-2">
              <i class="fas fa-star mr-1"></i>
              แนะนำ
            </div>
          </div>
          <div class="p-4 pt-0 text-center">
            {% if latest_prediction and latest_prediction.get_three_digit_list %}
              <div class="text-3xl font-bold text-primary mb-2">{{ latest_prediction.get_three_digit_list.0 }}</div>
              <div class="text-sm text-muted-foreground">ความแม่นยำ {{ latest_prediction.overall_confidence|floatformat:0 }}%</div>
            {% else %}
              <div class="text-3xl font-bold text-primary mb-2">427</div>
              <div class="text-sm text-muted-foreground">ความแม่นยำ 87%</div>
            {% endif %}
          </div>
        </div>

        <div class="card border-secondary/20 bg-secondary/5">
          <div class="p-4 text-center pb-2">
            <h3 class="text-lg font-serif text-foreground mb-2">เลขฮิต</h3>
            <div class="badge badge-secondary mx-auto mb-2">
              <i class="fas fa-chart-line mr-1"></i>
              ยอดนิยม
            </div>
          </div>
          <div class="p-4 pt-0 text-center">
            {% if latest_prediction and latest_prediction.get_two_digit_list %}
              <div class="text-3xl font-bold text-secondary mb-2">{{ latest_prediction.get_two_digit_list.0 }}</div>
              <div class="text-sm text-muted-foreground">ออกบ่อย</div>
            {% else %}
              <div class="text-3xl font-bold text-secondary mb-2">15</div>
              <div class="text-sm text-muted-foreground">ออกบ่อย 15 ครั้ง</div>
            {% endif %}
          </div>
        </div>

        <div class="card border-accent/20 bg-accent/5">
          <div class="p-4 text-center pb-2">
            <h3 class="text-lg font-serif text-foreground mb-2">เลขเสริมดวง</h3>
            <div class="badge badge-outline mx-auto mb-2">
              <i class="fas fa-moon mr-1"></i>
              จากความฝัน
            </div>
          </div>
          <div class="p-4 pt-0 text-center">
            {% if latest_prediction and latest_prediction.get_two_digit_list|length > 1 %}
              <div class="text-3xl font-bold text-accent mb-2">{{ latest_prediction.get_two_digit_list.1 }}</div>
              <div class="text-sm text-muted-foreground">จาก AI</div>
            {% else %}
              <div class="text-3xl font-bold text-accent mb-2">89</div>
              <div class="text-sm text-muted-foreground">ฝันเห็นงู</div>
            {% endif %}
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Daily Stats & Quick Info -->
  <section class="py-8 bg-card/30">
    <div class="container mx-auto px-4">
      <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
        <div class="text-center p-4">
          <div class="text-2xl font-bold text-primary mb-1">{{ site_stats.total_visitors_today|floatformat:0 }}</div>
          <div class="text-sm text-muted-foreground">คนเข้าชมวันนี้</div>
        </div>
        <div class="text-center p-4">
          <div class="text-2xl font-bold text-secondary mb-1">{{ site_stats.accuracy_percentage }}%</div>
          <div class="text-sm text-muted-foreground">ความแม่นยำเฉลี่ย</div>
        </div>
        <div class="text-center p-4">
          <div class="text-2xl font-bold text-accent mb-1">{{ site_stats.total_predictions }}</div>
          <div class="text-sm text-muted-foreground">เลขที่ทำนายแล้ว</div>
        </div>
        <div class="text-center p-4">
          <div class="text-2xl font-bold text-primary mb-1">{{ site_stats.total_news_today }}</div>
          <div class="text-sm text-muted-foreground">ข่าวใหม่วันนี้</div>
        </div>
      </div>
    </div>
  </section>

  <!-- Main Content Sections -->
  <section class="py-16" id="today">
    <div class="container mx-auto px-4">
      <div class="grid lg:grid-cols-3 gap-8">
        <!-- Left Column - Main Content -->
        <div class="lg:col-span-2 space-y-8">
          <!-- Latest Lottery News -->
          <div>
            <div class="flex items-center justify-between mb-6">
              <h3 class="text-2xl font-serif font-bold text-foreground flex items-center gap-2">
                <i class="fas fa-newspaper text-primary"></i>
                ข่าวหวยล่าสุด
              </h3>
              <a href="/news/" class="btn btn-outline">ดูทั้งหมด</a>
            </div>

            <div class="space-y-4">
              {% for article in latest_news %}
              <a href="{{ article.get_absolute_url }}" class="block">
                <div class="card hover:shadow-md transition-shadow">
                  <div class="p-4">
                    <div class="flex gap-4">
                      {% if article.featured_image %}
                        <div class="w-16 h-16 rounded-lg overflow-hidden flex-shrink-0">
                          <img src="{{ article.featured_image.url }}" alt="{{ article.title }}" class="w-full h-full object-cover">
                        </div>
                      {% else %}
                        <div class="w-16 h-16 bg-primary/10 rounded-lg flex items-center justify-center flex-shrink-0">
                          <i class="fas fa-newspaper text-primary text-2xl"></i>
                        </div>
                      {% endif %}
                      <div class="flex-1">
                        <h4 class="font-semibold mb-2 text-foreground hover:text-primary transition-colors">{{ article.title }}</h4>
                        <p class="text-sm text-muted-foreground mb-2">{{ article.intro|truncatechars:100 }}</p>
                        {% if article.get_extracted_numbers_list %}
                          <div class="flex gap-1 mb-2">
                            {% for number in article.get_extracted_numbers_list|slice:":3" %}
                              <span class="badge badge-outline text-xs">{{ number }}</span>
                            {% endfor %}
                          </div>
                        {% endif %}
                        <div class="flex items-center gap-4 text-xs text-muted-foreground">
                          <span class="flex items-center gap-1">
                            <i class="fas fa-clock"></i>{{ article.published_date|timesince }} ที่แล้ว
                          </span>
                          <span class="flex items-center gap-1">
                            <i class="fas fa-users"></i>
                            อ่าน {{ article.views }} ครั้ง
                          </span>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </a>
              {% empty %}
              <div class="card hover:shadow-md transition-shadow">
                <div class="p-4">
                  <div class="flex gap-4">
                    <div class="w-16 h-16 bg-primary/10 rounded-lg flex items-center justify-center flex-shrink-0">
                      <i class="fas fa-newspaper text-primary text-2xl"></i>
                    </div>
                    <div class="flex-1">
                      <h4 class="font-semibold mb-2">ยังไม่มีข่าวล่าสุด</h4>
                      <p class="text-sm text-muted-foreground mb-2">กรุณาติดตามข่าวสารในภายหลัง</p>
                    </div>
                  </div>
                </div>
              </div>
              {% endfor %}
            </div>
          </div>

          <!-- Lottery Locations -->
          <div id="locations">
            <h3 class="text-2xl font-serif font-bold text-foreground mb-6 flex items-center gap-2">
              <i class="fas fa-map-pin text-primary"></i>
              พิกัดเลขเด็ด - สถานที่ขอหวย
            </h3>

            <div class="grid md:grid-cols-2 gap-4">
              {% for location in popular_lucky_locations %}
              <a href="{{ location.get_absolute_url }}" class="block">
                <div class="card hover:shadow-md transition-shadow">
                  <div class="p-4">
                    <div class="flex gap-4">
                      {% if location.main_image %}
                        <div class="w-16 h-16 rounded-lg overflow-hidden flex-shrink-0">
                          <img src="{{ location.main_image.url }}" alt="{{ location.name }}" class="w-full h-full object-cover">
                        </div>
                      {% else %}
                        <div class="w-16 h-16 bg-primary/10 rounded-lg flex items-center justify-center flex-shrink-0">
                          {% if location.category.icon %}
                            <i class="{{ location.category.icon }} text-primary text-xl"></i>
                          {% else %}
                            <i class="fas fa-map-pin text-primary text-xl"></i>
                          {% endif %}
                        </div>
                      {% endif %}
                      <div class="flex-1">
                        <h4 class="font-semibold mb-1 text-foreground hover:text-primary transition-colors">{{ location.name }}</h4>
                        <p class="text-sm text-muted-foreground mb-2">
                          {{ location.province.name }} - {{ location.category.get_name_display }}
                          {% if location.get_lucky_numbers_list %}
                            <br>เลขเด่น: {{ location.get_lucky_numbers_list|slice:":3"|join:", " }}
                          {% endif %}
                        </p>
                        <div class="flex items-center justify-between">
                          <span class="badge badge-outline text-xs">
                            <i class="fas fa-eye mr-1"></i>
                            {{ location.views_count }} ครั้ง
                          </span>
                          <div class="text-xs text-muted-foreground">
                            <i class="fas fa-navigation mr-1"></i>
                            ดูรายละเอียด
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </a>
              {% empty %}
              <!-- Fallback content if no locations found -->
              <div class="card hover:shadow-md transition-shadow">
                <div class="p-4">
                  <div class="flex gap-4">
                    <div class="w-16 h-16 bg-primary/10 rounded-lg flex items-center justify-center flex-shrink-0">
                      <i class="fas fa-map-pin text-primary text-xl"></i>
                    </div>
                    <div class="flex-1">
                      <h4 class="font-semibold mb-1 text-foreground">วัดไผ่ล้อม</h4>
                      <p class="text-sm text-muted-foreground mb-2">วัดดังขอเลขเด็ด เลขที่ออกบ่อย: 27, 72, 07</p>
                      <div class="flex items-center justify-between">
                        <span class="badge badge-outline text-xs">
                          <i class="fas fa-star mr-1"></i>
                          ยอดนิยม
                        </span>
                        <div class="text-xs text-muted-foreground">
                          <i class="fas fa-navigation mr-1"></i>
                          ดูรายละเอียด
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="card hover:shadow-md transition-shadow">
                <div class="p-4">
                  <div class="flex gap-4">
                    <div class="w-16 h-16 bg-secondary/10 rounded-lg flex items-center justify-center flex-shrink-0">
                      <i class="fas fa-map-pin text-secondary text-xl"></i>
                    </div>
                    <div class="flex-1">
                      <h4 class="font-semibold mb-1 text-foreground">ศาลเจ้าพ่อหลักเมือง</h4>
                      <p class="text-sm text-muted-foreground mb-2">ศาลเจ้าศักดิ์สิทธิ์ เลขแนะนำ: 89, 98, 19</p>
                      <div class="flex items-center justify-between">
                        <span class="badge badge-secondary text-xs">
                          <i class="fas fa-trophy mr-1"></i>
                          แม่นยำสูง
                        </span>
                        <div class="text-xs text-muted-foreground">
                          <i class="fas fa-navigation mr-1"></i>
                          ดูรายละเอียด
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              {% endfor %}
            </div>

            <div class="mt-6 text-center">
              <a href="/lucky_spots/" class="btn btn-outline">
                <i class="fas fa-map-pin mr-2"></i>
                ดูพิกัดเลขเด็ดทั้งหมด
              </a>
            </div>
          </div>

          <!-- Dream Interpretation -->
          <div>
            <h3 class="text-2xl font-serif font-bold text-foreground mb-6 flex items-center gap-2">
              <i class="fas fa-moon text-primary"></i>
              แปลความฝันวันนี้
            </h3>

            <div class="card">
              <div class="p-6">
                <div class="space-y-4">
                  <div class="bg-muted/50 p-4 rounded-lg">
                    <h4 class="font-semibold mb-2 text-foreground">ความฝันยอดนิยม: "ฝันเห็นงูใหญ่สีเขียว"</h4>
                    <p class="text-sm text-muted-foreground mb-3">
                      งูสีเขียวในความฝันแทนความโชคดีและเงินทอง แนะนำเลข 89, 98, 08
                    </p>
                    <div class="flex gap-2">
                      <span class="badge badge-outline">89</span>
                      <span class="badge badge-outline">98</span>
                      <span class="badge badge-outline">08</span>
                    </div>
                  </div>

                  <div class="space-y-3">
                    <textarea 
                      id="dreamInput"
                      placeholder="เล่าความฝันของคุณ..." 
                      rows="3" 
                      class="textarea resize-none"
                    ></textarea>
                    <button onclick="interpretDream()" id="dreamBtn" class="btn btn-primary w-full">
                      <i class="fas fa-moon mr-2"></i>
                      แปลความฝันของฉัน
                    </button>
                  </div>

                  <!-- Loading -->
                  <div id="dreamLoading" class="hidden text-center py-4">
                    <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary"></div>
                    <p class="mt-2 text-muted-foreground">กำลังวิเคราะห์ความฝัน...</p>
                  </div>
                  
                  <!-- Results -->
                  <div id="dreamResults" class="hidden">
                    <div class="bg-primary/10 rounded-lg p-4 mb-4">
                      <h4 class="font-semibold text-primary mb-2">คำทำนาย:</h4>
                      <p id="dreamInterpretation" class="text-foreground"></p>
                    </div>
                    
                    <div class="bg-muted/50 rounded-lg p-4 mb-4">
                      <h4 class="font-semibold text-foreground mb-3">เลขมงคลจากความฝัน:</h4>
                      <div id="dreamNumbers" class="grid grid-cols-3 gap-3"></div>
                    </div>
                    
                    <button onclick="resetDreamForm()" class="btn btn-outline w-full">
                      ตีความใหม่
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Right Sidebar -->
        <div class="space-y-6">
          <!-- Quick Lottery Check -->
          <div class="card">
            <div class="p-4 border-b">
              <h3 class="font-serif flex items-center gap-2 text-lg font-bold text-foreground">
                <i class="fas fa-search text-primary"></i>
                ตรวจหวยด่วน
              </h3>
            </div>
            <div class="p-4 space-y-3">
              <input 
                id="lotteryInput"
                placeholder="กรอกเลข 6 หลัก" 
                class="input"
                maxlength="6"
                pattern="[0-9]{6}"
              />
              <button onclick="checkLottery()" id="lotteryBtn" class="btn btn-primary w-full">ตรวจผลหวย</button>
              <a href="/lottery_checker/" class="btn btn-outline w-full">
                <i class="fas fa-search mr-2"></i>
                ไปหน้าตรวจหวยแบบละเอียด
              </a>
              {% if latest_lottery_result %}
              <div class="text-xs text-muted-foreground text-center">งวดล่าสุด: {{ latest_lottery_result.formatted_date }}</div>
              {% endif %}

              <!-- Loading -->
              <div id="lotteryLoading" class="hidden text-center py-4">
                <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary"></div>
                <p class="mt-2 text-muted-foreground">กำลังตรวจสอบ...</p>
              </div>
              
              <!-- Results -->
              <div id="lotteryResults" class="hidden">
                <div class="bg-primary/10 rounded-lg p-4 mb-4">
                  <h4 class="font-semibold text-primary mb-2">ผลการตรวจสอบ:</h4>
                  <div id="lotteryResultText" class="text-foreground"></div>
                </div>
                
                <button onclick="resetLotteryForm()" class="btn btn-outline w-full">
                  ตรวจใหม่
                </button>
              </div>
            </div>
          </div>

          <!-- Hot Numbers -->
          <div class="card">
            <div class="p-4 border-b">
              <h3 class="font-serif flex items-center gap-2 text-lg font-bold text-foreground">
                <i class="fas fa-chart-bar text-secondary"></i>
                เลขฮิตประจำสัปดาห์
              </h3>
            </div>
            <div class="p-4">
              <div class="space-y-3">
                <div class="flex justify-between items-center">
                  <span class="text-sm text-foreground">เลขออกบ่อย</span>
                  <div class="flex gap-1">
                    <span class="badge badge-secondary">07</span>
                    <span class="badge badge-secondary">23</span>
                    <span class="badge badge-secondary">45</span>
                  </div>
                </div>
                <div class="flex justify-between items-center">
                  <span class="text-sm text-foreground">เลขไม่เคยออก</span>
                  <div class="flex gap-1">
                    <span class="badge badge-outline">89</span>
                    <span class="badge badge-outline">91</span>
                    <span class="badge badge-outline">96</span>
                  </div>
                </div>
                <div class="flex justify-between items-center">
                  <span class="text-sm text-foreground">เลขแนวโน้มสูง</span>
                  <div class="flex gap-1">
                    <span class="badge bg-accent text-accent-foreground">12</span>
                    <span class="badge bg-accent text-accent-foreground">34</span>
                    <span class="badge bg-accent text-accent-foreground">56</span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- AI Prediction -->
          <div class="card border-primary/20">
            <div class="p-4 border-b">
              <h3 class="font-serif flex items-center gap-2 text-lg font-bold text-foreground">
                <i class="fas fa-brain text-primary"></i>
                AI ทำนายใหม่
              </h3>
            </div>
            <div class="p-4">
              <div class="text-center space-y-4">
                <div>
                  {% if latest_prediction %}
                    <div class="text-2xl font-bold text-primary mb-1">{{ latest_prediction.get_three_digit_list.0|default:"427" }}</div>
                    <div class="text-sm text-muted-foreground">เลขบน 3 ตัว</div>
                    <div class="badge bg-primary/10 text-primary mt-2">{{ latest_prediction.overall_confidence|floatformat:0|default:"87" }}% แม่นยำ</div>
                  {% else %}
                    <div class="text-2xl font-bold text-primary mb-1">427</div>
                    <div class="text-sm text-muted-foreground">เลขบน 3 ตัว</div>
                    <div class="badge bg-primary/10 text-primary mt-2">87% แม่นยำ</div>
                  {% endif %}
                </div>
                <a href="/ai/" class="btn btn-primary w-full">
                  <i class="fas fa-bolt mr-2"></i>
                  สร้างเลขใหม่
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>


<script>
// Dream Interpretation Functions
async function interpretDream() {
    const dreamInput = document.getElementById('dreamInput');
    const dreamBtn = document.getElementById('dreamBtn');
    const dreamLoading = document.getElementById('dreamLoading');
    const dreamResults = document.getElementById('dreamResults');
    
    const dreamText = dreamInput.value.trim();
    
    if (!dreamText) {
        alert('กรุณากรอกความฝันของคุณ');
        return;
    }
    
    // Show loading
    dreamLoading.classList.remove('hidden');
    dreamBtn.disabled = true;
    dreamResults.classList.add('hidden');
    
    try {
        const response = await fetch('/dreams/analyze/', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRFToken': getCookie('csrftoken')
            },
            body: JSON.stringify({
                dream_text: dreamText
            })
        });
        
        const data = await response.json();
        
        if (data.success) {
            // Show results
            document.getElementById('dreamInterpretation').textContent = data.result.interpretation;
            
            // Show numbers
            const numbersContainer = document.getElementById('dreamNumbers');
            numbersContainer.innerHTML = '';
            
            data.result.numbers.forEach(number => {
                const div = document.createElement('div');
                div.className = 'bg-card border border-border rounded-lg p-3 text-center';
                div.innerHTML = `<span class="text-xl font-bold text-primary">${number}</span>`;
                numbersContainer.appendChild(div);
            });
            
            dreamResults.classList.remove('hidden');
        } else {
            alert(data.error || 'เกิดข้อผิดพลาด กรุณาลองใหม่');
        }
    } catch (error) {
        alert('เกิดข้อผิดพลาด: ' + error.message);
    } finally {
        dreamLoading.classList.add('hidden');
        dreamBtn.disabled = false;
    }
}

function resetDreamForm() {
    document.getElementById('dreamInput').value = '';
    document.getElementById('dreamResults').classList.add('hidden');
    document.getElementById('dreamLoading').classList.add('hidden');
    document.getElementById('dreamBtn').disabled = false;
}

// Lottery Checker Functions
async function checkLottery() {
    const lotteryInput = document.getElementById('lotteryInput');
    const lotteryBtn = document.getElementById('lotteryBtn');
    const lotteryLoading = document.getElementById('lotteryLoading');
    const lotteryResults = document.getElementById('lotteryResults');
    const lotteryResultText = document.getElementById('lotteryResultText');

    const lotteryNumber = lotteryInput.value.trim();

    if (!lotteryNumber) {
        alert('กรุณากรอกเลขสลากที่ต้องการตรวจ');
        return;
    }

    if (!/^\d{6}$/.test(lotteryNumber)) {
        alert('กรุณากรอกเลข 6 หลัก');
        return;
    }

    // Show loading
    lotteryLoading.classList.remove('hidden');
    lotteryBtn.disabled = true;
    lotteryResults.classList.add('hidden');
    lotteryResultText.textContent = ''; // Clear previous results

    try {
        const response = await fetch('/lottery_checker/api/check/', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRFToken': getCookie('csrftoken')
            },
            body: JSON.stringify({
                lottery_number: lotteryNumber
            })
        });

        const data = await response.json();

        if (data.success) {
            // Show results with color coding
            const resultDiv = document.createElement('div');
            if (data.result.is_winner) {
                resultDiv.innerHTML = `
                    <div class="text-green-600 font-bold mb-2">🎉 ยินดีด้วย!</div>
                    <div class="text-foreground">${data.result.message}</div>
                `;
                resultDiv.className = 'p-3 bg-green-50 border border-green-200 rounded-lg';
            } else {
                resultDiv.innerHTML = `
                    <div class="text-orange-600 font-bold mb-2">ผลการตรวจสอบ</div>
                    <div class="text-foreground">${data.result.message}</div>
                `;
                resultDiv.className = 'p-3 bg-orange-50 border border-orange-200 rounded-lg';
            }
            
            lotteryResultText.innerHTML = '';
            lotteryResultText.appendChild(resultDiv);
            lotteryResults.classList.remove('hidden');
        } else {
            lotteryResultText.innerHTML = `
                <div class="p-3 bg-red-50 border border-red-200 rounded-lg">
                    <div class="text-red-600 font-bold mb-2">เกิดข้อผิดพลาด</div>
                    <div class="text-foreground">${data.error || 'เกิดข้อผิดพลาด กรุณาลองใหม่'}</div>
                </div>
            `;
            lotteryResults.classList.remove('hidden');
        }
    } catch (error) {
        lotteryResultText.innerHTML = `
            <div class="p-3 bg-red-50 border border-red-200 rounded-lg">
                <div class="text-red-600 font-bold mb-2">เกิดข้อผิดพลาด</div>
                <div class="text-foreground">ไม่สามารถเชื่อมต่อกับเซิร์ฟเวอร์ได้</div>
            </div>
        `;
        lotteryResults.classList.remove('hidden');
    } finally {
        lotteryLoading.classList.add('hidden');
        lotteryBtn.disabled = false;
    }
}

function resetLotteryForm() {
    document.getElementById('lotteryInput').value = '';
    document.getElementById('lotteryResults').classList.add('hidden');
    document.getElementById('lotteryLoading').classList.add('hidden');
    document.getElementById('lotteryResultText').textContent = '';
    document.getElementById('lotteryBtn').disabled = false;
}

// Utility function to get CSRF token
function getCookie(name) {
    let cookieValue = null;
    if (document.cookie && document.cookie !== '') {
        const cookies = document.cookie.split(';');
        for (let i = 0; i < cookies.length; i++) {
            const cookie = cookies[i].trim();
            if (cookie.substring(0, name.length + 1) === (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
}

// Enter key support for inputs
document.addEventListener('DOMContentLoaded', function() {
    const dreamInput = document.getElementById('dreamInput');
    if (dreamInput) {
        dreamInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                interpretDream();
            }
        });
    }
    
    const lotteryInput = document.getElementById('lotteryInput');
    if (lotteryInput) {
        lotteryInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                checkLottery();
            }
        });
    }
});
</script>

{% block extra_js %}
<script src="{% static 'js/theme.js' %}"></script>
{% endblock %}
{% endblock %}